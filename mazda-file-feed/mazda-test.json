{
  "name" : "mazda-test",
  "description" : "",
  "role" : "arn:aws:iam::858953035784:role/service-role/Amazon-GlueServiceRoleForSSM",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-858953035784-us-east-1/scripts/mazda_test.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--spark-event-logs-path" : "s3://aws-glue-assets-858953035784-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "false",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-858953035784-us-east-1/temporary/"
  },
  "connections" : {
    "connections" : [ "on_prime_connection" ]
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "4.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1691576320975\":{\"CustomCode\":{\"ClassName\":\"MyTransform\",\"Code\":\"\\n# Establish a JDBC connection to the SQL Server database\\njdbc_url = \\\"jdbc:sqlserver://QTSDEVSQL4.etch.com\\\\\\\\DEVALPHA;databaseName=SGEAS_DIFF;encrypt=true;trustServerCertificate=true;integratedSecurity=false;authenticationScheme=NTLM\\\"\\nconnection_properties = {\\n\\\"user\\\": \\\"devsqlcs31api\\\",\\n\\\"password\\\": \\\"DEV$1*31^IP\\\",\\n\\\"driver\\\": \\\"com.microsoft.sqlserver.jdbc.SQLServerDriver\\\"\\n}\\n\\n# Call the stored procedure\\nsql_query = \\\"CREATE TABLE ##DealerUpsert (DealerNumber VARCHAR(200), DealerDBA VARCHAR(200), DealerType VARCHAR(200), AgentCode VARCHAR(200), PhoneNumber VARCHAR(200), FaxNumber VARCHAR(200), City VARCHAR(200), State VARCHAR(200), Address1 VARCHAR(200), Address2 VARCHAR(200), Address3 VARCHAR(200), Zip VARCHAR(200), County VARCHAR(200), ActiveDlrStatusDate VARCHAR(200), EndDate VARCHAR(200), OutOfBusiness VARCHAR(200), IPEDate VARCHAR(200), EnrolDate VARCHAR(200), PaymentType VARCHAR(200), DealerLanguage VARCHAR(200), ModifiedBy VARCHAR(200), CreatedBy VARCHAR(200), CreatedDate VARCHAR(200), ModifiedDate VARCHAR(200)); INSERT INTO ##DealerUpsert (DealerNumber, DealerDBA, DealerType, AgentCode, PhoneNumber, FaxNumber, City, State, Address1, Address2, Address3, Zip, County, ActiveDlrStatusDate, EndDate, OutOfBusiness, IPEDate, EnrolDate, PaymentType, DealerLanguage, ModifiedBy, CreatedBy, CreatedDate, ModifiedDate) VALUES ('34664', 'BARNES CROSSING', '', '', '6628441384', '6628440465', 'TUPELO', 'MS', '3983 N GLOSTER ST', '', '', '38804', 'US', '', '2022-06-01', '1799-12-31', '1799-12-31', '1799-12-31', 'PS', 'EN', 'MULESOFT', 'MULESOFT', '2023-08-09', '2023-08-09'); EXEC dbo.upsertDealer; DROP table ##DealerUpsert;\\\"\\ndf = spark.read.jdbc(url=jdbc_url, table=sql_query, properties=connection_properties)\\n\\n# Convert DataFrame to DynamicFrame and continue with Glue transformations\\ndynamic_frame = DynamicFrame.fromDF(df, glueContext, \\\"dynamic_frame\\\")\\n\\n# Continue with your Glue transformations or write to the desired target\\n\",\"Inputs\":[\"node-1691503681162\"],\"Name\":\"Custom Transform\"}},\"node-1691503681162\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1691503681066\"],\"Name\":\"output_group_1\"}},\"node-1691503681066\":{\"Route\":{\"GroupFiltersList\":[{\"Filters\":[],\"GroupName\":\"default_group\",\"LogicalOperator\":\"AND\"},{\"Filters\":[{\"Negated\":false,\"Operation\":\"REGEX\",\"Values\":[{\"Type\":\"CONSTANT\",\"Value\":[\"Pass\"]},{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"DataQualityEvaluationResult\"]}]}],\"GroupName\":\"output_group_1\",\"LogicalOperator\":\"AND\"}],\"Inputs\":[\"node-1691502732311\"],\"Name\":\"Conditional Router\"}},\"node-1691503681158\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1691503681066\"],\"Name\":\"default_group\"}},\"node-1691495658449\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1691493280307\"],\"Name\":\"ruleOutcomes\"}},\"node-1691502732311\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1691493280307\"],\"Name\":\"rowLevelOutcomes\"}},\"node-1691493280307\":{\"EvaluateDataQualityMultiFrame\":{\"AdditionalDataSources\":{},\"AdditionalOptions\":{\"performanceTuning.caching\":\"CACHE_NOTHING\"},\"Inputs\":[\"node-1691488062747\"],\"Name\":\"Evaluate Data Quality\",\"PublishingOptions\":{\"CloudWatchMetricsEnabled\":true,\"ResultsPublishingEnabled\":true},\"Ruleset\":\"# Example rules: Completeness \\\"colA\\\" between 0.4 and 0.8, ColumnCount > 10\\nRules = [\\n   ColumnDataType \\\"dlrnumber\\\" = \\\"integer\\\" ,ColumnExists \\\"dlrnumber\\\", ColumnLength \\\"dlrnumber\\\" > 1, ColumnLength \\\"dlrnumber\\\" < 9\\n]\",\"StopJobOnFailureOptions\":{}}},\"node-1691488062747\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":true,\"SamplePath\":\"s3://non-auto-contracts-test/mazda_dealerlist.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Multiline\":true,\"Name\":\"Amazon S3\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"DlrNumber\",\"Type\":\"string\"},{\"Name\":\"DlrDBAName\",\"Type\":\"string\"},{\"Name\":\"DlrType\",\"Type\":\"string\"},{\"Name\":\"DealerType\",\"Type\":\"string\"},{\"Name\":\"FranchiseAgrmntExpDt\",\"Type\":\"string\"},{\"Name\":\"DlrStatusCd\",\"Type\":\"string\"},{\"Name\":\"ActiveDlrStatusDt\",\"Type\":\"string\"},{\"Name\":\"AgentCode\",\"Type\":\"string\"},{\"Name\":\"DlrBillingAdrsStrtName\",\"Type\":\"string\"},{\"Name\":\"DlrBillingAdrsStrtName2\",\"Type\":\"string\"},{\"Name\":\"DlrBillingAdrsStrtName3\",\"Type\":\"string\"},{\"Name\":\"DlrBillingcityName\",\"Type\":\"string\"},{\"Name\":\"DlrBillingstateCd\",\"Type\":\"string\"},{\"Name\":\"DlrBillingZipCd\",\"Type\":\"string\"},{\"Name\":\"DlrBillingZipCdExension\",\"Type\":\"string\"},{\"Name\":\"DlrPhoneNumber\",\"Type\":\"string\"},{\"Name\":\"DlrFaxNumber\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsCity\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsCntryName\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsCountyName\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsStateName\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsStrtName\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsStrt2Name\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsStrt3Name\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsZipCd\",\"Type\":\"string\"},{\"Name\":\"DlrPhysicalAdrsZipCdExt\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrs_City\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsCntry_Name\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsCountyName\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsStateName\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsStrtName\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsStrt2Name\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsStrt3Name\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsZipCd\",\"Type\":\"string\"},{\"Name\":\"DlrMailingAdrsZipCdExt\",\"Type\":\"string\"},{\"Name\":\"DlrLaborRate\",\"Type\":\"string\"},{\"Name\":\"LastUpDtdDt\",\"Type\":\"string\"},{\"Name\":\"RegionNbr\",\"Type\":\"string\"},{\"Name\":\"SaleDate\",\"Type\":\"string\"},{\"Name\":\"RegionName\",\"Type\":\"string\"},{\"Name\":\"RegionMgrFirstNm\",\"Type\":\"string\"},{\"Name\":\"RegionMgrMiddleNm\",\"Type\":\"string\"},{\"Name\":\"RegionMgrLastNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioRegionNumber\",\"Type\":\"string\"},{\"Name\":\"PortfolioRegionNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioRegionMgrFirstNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioRegionMgrMiddleNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioRegionMgrLastNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioAreaNum\",\"Type\":\"string\"},{\"Name\":\"PortfolioAreaNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioSalesMgrFirstNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioSalesMgrMiddleNm\",\"Type\":\"string\"},{\"Name\":\"PortfolioSalesMgrLastNm\",\"Type\":\"string\"},{\"Name\":\"ProductMgrNum\",\"Type\":\"string\"},{\"Name\":\"ProductMgrFirstNm\",\"Type\":\"string\"},{\"Name\":\"ProductMgrMiddleNm\",\"Type\":\"string\"},{\"Name\":\"ProductMgrLastNm\",\"Type\":\"string\"},{\"Name\":\"SalesArea\",\"Type\":\"string\"},{\"Name\":\"ASMFirstNm\",\"Type\":\"string\"},{\"Name\":\"ASMMiddleNm\",\"Type\":\"string\"},{\"Name\":\"ASMLastNm\",\"Type\":\"string\"},{\"Name\":\"ASMEmail\",\"Type\":\"string\"},{\"Name\":\"ASMStartDate\",\"Type\":\"string\"},{\"Name\":\"LastUpdtdDt\",\"Type\":\"string\"},{\"Name\":\"LastCreatedBy\",\"Type\":\"string\"},{\"Name\":\"PaymentType\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://non-auto-contracts-test\"],\"QuoteChar\":\"single_quote\",\"Recurse\":true,\"Separator\":\"pipe\",\"WithHeader\":true}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "aws-glue-jobs",
    "branch" : "feature/mazda-test",
    "folder" : "mazda-file-feed"
  }
}